(self.webpackChunkdev_portal=self.webpackChunkdev_portal||[]).push([[970],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return p},kt:function(){return c}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),d=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(a),c=r,h=m["".concat(i,".").concat(c)]||m[c]||u[c]||o;return a?n.createElement(h,s(s({ref:t},p),{},{components:a})):n.createElement(h,s({ref:t},p))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var d=2;d<o;d++)s[d]=a[d];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9489:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return l},metadata:function(){return i},toc:function(){return d},default:function(){return u}});var n=a(2122),r=a(9756),o=(a(7294),a(3905)),s=["components"],l={title:"Deposit funds",sidebar_position:3},i={unversionedId:"provider/daemon/deposit_funds",id:"provider/daemon/deposit_funds",isDocsHomePage:!1,title:"Deposit funds",description:"To create a market, you need to deposit two reserves of two Liquid assets for the pair (called Market) you are providing liquidity for. Each Market has a BASE ASSET, which is always the same per daemon, and a QUOTE ASSET.",source:"@site/docs/provider/daemon/deposit_funds.md",sourceDirName:"provider/daemon",slug:"/provider/daemon/deposit_funds",permalink:"/docs/provider/daemon/deposit_funds",editUrl:"https://github.com/tdex-network/dev-portal/edit/master/docs/provider/daemon/deposit_funds.md",version:"current",sidebarPosition:3,frontMatter:{title:"Deposit funds",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Configure CLI",permalink:"/docs/provider/daemon/getting_started/configure_cli"},next:{title:"Webhooks",permalink:"/docs/provider/daemon/webhooks"}},d=[{value:"Initialize and unlock the wallet",id:"initialize-and-unlock-the-wallet",children:[]},{value:"Deposit funds",id:"deposit-funds",children:[{value:"Manual deposit",id:"manual-deposit",children:[]},{value:"Fragmenter tool",id:"fragmenter-tool",children:[]}]},{value:"Manage a market",id:"manage-a-market",children:[]}],p={toc:d};function u(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"To create a market, you need to deposit two reserves of two ",(0,o.kt)("strong",{parentName:"p"},"Liquid assets")," for the pair (called ",(0,o.kt)("strong",{parentName:"p"},"Market"),") you are providing liquidity for. Each ",(0,o.kt)("strong",{parentName:"p"},"Market")," has a BASE ASSET, which is always the same per daemon, and a QUOTE ASSET."),(0,o.kt)("p",null,"To determine the spot price you can adopt different strategies, at the moment the supported one are ",(0,o.kt)("strong",{parentName:"p"},"PLUGGABLE")," and ",(0,o.kt)("strong",{parentName:"p"},"BALANCED"),"."),(0,o.kt)("p",null,"The PLUGGABLE strategy expects you to update the price manually, plugging in an external price feed that need to call the ",(0,o.kt)("inlineCode",{parentName:"p"},"UpdateMarketPrice")," rpc method of the operator interface."),(0,o.kt)("p",null,"The BALANCED strategy (this is the default when you create a market) uses ",(0,o.kt)("strong",{parentName:"p"},"Automated Market Making")," to determine the spot price. The initial ratio of the two amounts you deposit will represent the price of the first trade you accept in.\nFrom that point on, the ",(0,o.kt)("strong",{parentName:"p"},"automated market making strategy will self regulate the trading price"),". It follows the ",(0,o.kt)("em",{parentName:"p"},"constant product market-making")," formula. Every transaction that occurs on this market will adjust the prices of the market accordingly. It's a basic supply and demand automated market making system."),(0,o.kt)("h2",{id:"initialize-and-unlock-the-wallet"},"Initialize and unlock the wallet"),(0,o.kt)("p",null,"The very first thing to do after you started your daemon is to setup the internal wallet.  "),(0,o.kt)("p",null,"If you want to create a new wallet, you should find useful generating a random mnemonic seed with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex genseed\n")),(0,o.kt)("p",null,"Now that you have a seed, you can initialize the daemon's wallet:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'$ tdex init --seed "<generatedSeed>" --password <mypassword>\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"OR"),", instead, if you want to import and restore an existing wallet:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'$ tdex init --seed "<mySeed>" --password <mypassword> --restore\n')),(0,o.kt)("p",null,"Keep in mind that restoring a wallet can take a while, depeneding on the total number of accounts and addresses-per-account generated."),(0,o.kt)("p",null,"The daemon locks its embedded wallet after the initalization has succeded, so the next step is to unlock it with the password:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex unlock --password <mypassword>\n")),(0,o.kt)("h2",{id:"deposit-funds"},"Deposit funds"),(0,o.kt)("p",null,"Finally, you are ready to deposit funds: you can either ",(0,o.kt)("a",{parentName:"p",href:"#manual-deposit"},"manually deposit funds")," to the daemon, or you can make use of the ","[fragmenter tool]"," that facilitates the process, empowering the daemon to serve an higher number of concurrent swap requests. "),(0,o.kt)("h3",{id:"manual-deposit"},"Manual deposit"),(0,o.kt)("p",null,"In order to manually send funds to the daemon wallet, you need to get a deposit address from the fee account:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ tdex depositfee [--num_of_addresses]\n")),(0,o.kt)("p",null,"Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--num_of_addresses")," flag to get more than one address to send funds to multiple addresses."),(0,o.kt)("p",null,"Now send some L-BTC that will be used to subsidize Liquid network fees."),(0,o.kt)("p",null,"After the transaction get confirmed, you can claim the deposits for the fee account:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'$ tdex claimfee --outpoints \'[{"hash": <txid>, "index": <vout>}]\'\n')),(0,o.kt)("p",null,"The same flow applies to create a market, so first of all get some address(es) for the market:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"# To create a new market and derive addresses for that account\n$ tdex depositmarket [--num_of_addresses]\n#\xa0To derive addresses for an already existing market\n$ tdex depositmarket --base_asset <basetAsset> --quote_asset <quoteAssethash> [--num_of_addresses]\n")),(0,o.kt)("p",null,"Now send some amount of base asset (by default is LBTC) and quote asset of choice to the address(es) - such as USDt or LCAD."),(0,o.kt)("p",null,"Again, after the tx gets confirmed you can claim the deposits for the market:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'# You need tell to the CLI for which market you are claiming the funds to\n$ tdex config set base_asset <baseAssethash>\n$ tdex config set quote_asset <quoteAssethash>\n\n$ tdex claimmarket --outpoints \'[{"hash": <txid>, "index": <vout>}, {...}]\'\n')),(0,o.kt)("h3",{id:"fragmenter-tool"},"Fragmenter tool"),(0,o.kt)("p",null,"You can make use of the fragmenter tool, an interactive process that let's you send all the funds to an ephemeral wallet that splits the total amount into smaller fragments, increasing the capabilities of the daemon to serve an higher number of concurrent trade requests:"),(0,o.kt)("p",null,"Get the address where to send fee account's funds to:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex fragmentfee\n#\xa0INFO[0000] send funds to address: el1qqtqj6psznm2km5axsj8qxgduzzznzjvmxfs3qh7h83hsp72hp0s5hzzwlzv92cgr44qtl4krrykddyv6xtcmvpusqraynmn0k\n#\xa0INFO[0000] Enter txid of fund(s) separated by a white space [press ENTER to skip or confirm]:\n")),(0,o.kt)("p",null,"After generating and showing the ephemeral address, the command waits for you to prompt the txid of the funding tx(s).",(0,o.kt)("br",{parentName:"p"}),"\n","Press ",(0,o.kt)("em",{parentName:"p"},"ENTER")," to confirm and continue the process: the tool calculates the optimal number of fragments based on the amount detected and sends the fragmented funds to the daemon's fee account."),(0,o.kt)("p",null,"If, for any reason, the process fails (like for example you pasted the wrong txid, or you forgot to unlock the wallet before this step) you can always resume it with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex fragmentfee --txid <txid1> --txid <txid2> ...\n")),(0,o.kt)("p",null,"The fragmenter is smart enough to recognize if any previous attempt exited before being completed. In that case, it expects you to resume that one by providing the list of funding txids. If this time everything's allright, the process will complete as described above, otherwise you'll need to repeat the resume again. Only after a fragmentation process is completed, it is possible to go for another one."),(0,o.kt)("p",null,"Now it's time to use the fragmenter to deposit market funds, so as before, get an ephemeral address where to send the Market reserves to:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex fragmentmarket\n#\xa0INFO[0000] send funds to address: el1qqf9w40vhwnq0rjejfuv0l4hlhgc6zwdacftra5yd3rakl8s3y0pn3078ul8jh5dhfg7rpceu2xt8wyx92wz9swqsm2p6fcjvq\n#\xa0INFO[0000] Enter txid of fund(s) separated by a white space [press ENTER to skip or confirm]:\n")),(0,o.kt)("p",null,"Fund the temporary wallet address and prompt the txid(s) of the funding tx(s).",(0,o.kt)("br",{parentName:"p"}),"\n","Press ",(0,o.kt)("em",{parentName:"p"},"ENTER")," to confirm and continue the process in order to calculate the optimal number of fragments and to send them to the daemon's market account."),(0,o.kt)("p",null,"If, for any reason, the process fails, the same resume flow described above applies for ",(0,o.kt)("inlineCode",{parentName:"p"},"fragmentmarket --txid <txid1> ..."),"."),(0,o.kt)("p",null,"You can check the status of the market with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex listmarket\n")),(0,o.kt)("h2",{id:"manage-a-market"},"Manage a market"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Set the CLI to work with the newly created market:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex config set base_asset <baseAssethash>\n$ tdex config set quote_asset <quoteAssethash>\n")),(0,o.kt)("p",null,"You can always check the current state with the following command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex config\n")),(0,o.kt)("p",null,"Now the following commands will be executed against this market."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Open the market using automated market making")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex open\n")),(0,o.kt)("p",null,"This makes the selected market available for trading using the BALANCED market strategy"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Close the market")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex close\n")),(0,o.kt)("p",null,"This makes the selected market NOT available for trading."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Update the percentage fee")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex percentagefee --basis_point 100\n")),(0,o.kt)("p",null,"This updates the current market percentage fee to 1% (by default it's 0.25%)."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Update the fixed fee")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex fixedfee --base_fee 600 --quote_fee 20000\n")),(0,o.kt)("p",null,"This updates the current market fixed fees (by default they're 0)."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Change market making strategy to pluggable")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex strategy --pluggable\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Update the price")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex price --base_price=16000 --quote-price=0.001\n")),(0,o.kt)("p",null,"This updates the current market price to be used for future trades."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Open the market again")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex open\n")),(0,o.kt)("p",null,"Congratulations! Your daemon is now ready to accept trade proposals from all over the world."),(0,o.kt)("p",null,"Check all the trades served by the daemon (including those ongoing and those that have been rejected or expired) with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ tdex listtrades\n")))}u.isMDXComponent=!0}}]);